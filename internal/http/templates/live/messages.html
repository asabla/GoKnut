{{define "live/messages.html"}}
{{/* Paginated message list fragment */}}
{{if .IsEmpty}}
    {{template "empty" (dict "Message" "No more messages")}}
{{else}}
    {{range .Messages}}
        {{template "live/message.html" .}}
    {{end}}
    
    {{if .HasNext}}
    <div class="text-center py-2">
        <button hx-get="/channels/{{.ChannelName}}/messages?page={{.NextPage}}"
                hx-target="this"
                hx-swap="outerHTML"
                class="text-sm text-twitch-purple hover:text-white transition-colors">
            Load more
            <span class="htmx-indicator ml-2">
                <svg class="animate-spin h-4 w-4 inline" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"/>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"/>
                </svg>
            </span>
        </button>
    </div>
    {{end}}
{{end}}
{{end}}
